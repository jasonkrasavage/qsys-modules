--[[ 

This is based on Technical Audio Group PJLink Controller.

High-jacked and updated to work specifically for 
PanasonicPT-RZ and PT-EW Series by 

Jarrett Bumgarner
Infinite Sound Solutions
jarrett@infinitesoundsolutions.com

Dont be a dick- Dont call this your own. 


Release Notes-

1.0- TAG Original

1.2- TAG updated MD5 Hash


2.0- Jarrett Hacked and changed polling method, major strippage and rewriting of call functions.



Known issues in 2.0:

AV Mute does not update Poll if state changed on Projector remotely.....sometimes....


]]



PluginInfo =
{
  Name = "PJLink Controller 2.0.1",
  Version = "2.0.1",
  Id = "37dbed4c-8509-493f-b5fb-122be6107612",
  Description = "PJLink projector control plugin",
  ShowDebug = false
}

require('json');

function GetProperties()

  return {
    {
      Name = 'Customise Inputs',
      Type = 'boolean',
      Value = true
    },
    
  };
  
end


function GetControls(props)

  local controls = {

    {
      Name = 'IP Address',
      ControlType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Both'
    },
    {
      Name = 'Port',
      ControlType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Both'
    },
    {
      Name = 'Password',
      ControlType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Both'
    },
    {
      Name = 'Power',
      ControlType = 'Button',
      ButtonType = 'Toggle',
      Count = 1,
      UserPin = true,
      PinStyle = 'Both'
    },
    {
      Name = 'Input',
      ControlType = 'Text',
      TextType = 'ComboBox',
      Count = 1,
      UserPin = true,
      PinStyle = 'Both'
    },
    {
      Name = 'AV Mute',
      ControlType = 'Button',
      ButtonType = 'Toggle',
      Count = 1,
      UserPin = true,
      PinStyle = 'Both'
    },
    {
      Name = 'Projector Name',
      ControlType = 'Indicator',
      IndicatorType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
    {
      Name = 'Manufacturer',
      ControlType = 'Indicator',
      IndicatorType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
    {
      Name = 'Product Name',
      ControlType = 'Indicator',
      IndicatorType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
    {
      Name = 'Lamp Hours',
      ControlType = 'Indicator',
      IndicatorType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
    {
      Name = 'Connection Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
    {
      Name = 'Extra Info',
      ControlType = 'Indicator',
      IndicatorType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
    {
      Name = 'Operational Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
    {
      Name = 'Fan Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
        {
      Name = 'Lamp Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
        {
      Name = 'Temp Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
        {
      Name = 'Cover Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
        {
      Name = 'Filter Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
        {
      Name = 'Other Status',
      ControlType = 'Indicator',
      IndicatorType = 'Status',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    },
  };

  if(props['Customise Inputs'].Value) then
    controls[#controls + 1] = {
      Name = 'Input Nicknames',
      ControlType = 'Text',
      Count = 45
    };
  end;

    table.insert(controls, {
      Name = 'Power Status',
      ControlType = 'Indicator',
      IndicatorType = 'Led',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    });
    table.insert(controls, {
      Name = 'AVMute Status',
      ControlType = 'Indicator',
      IndicatorType = 'Led',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    });
    table.insert(controls, {
      Name = 'Current Input',
      ControlType = 'Indicator',
      IndicatorType = 'Text',
      Count = 1,
      UserPin = true,
      PinStyle = 'Output'
    });
  

  return controls;

end;

function GetControlLayout(props)

  local bgColor = {235, 245, 252};

  -- PJLink Controls Only
  local ControlLayout = {};
  ControlLayout['IP Address'] = {
    Style = 'Box',
    Position = { 147, 15 },
    Size = { 76, 16 }
  };
  ControlLayout['Port'] = {
    Style = 'Box',
    Position = { 231, 15 },
    Size = { 36, 16 }
  };
  ControlLayout['Password'] = {
    Style = 'Box',
    Position = { 147, 31 },
    Size = { 120, 16 }
  };
  ControlLayout['Connection Status'] = {
    Style = 'Text',
    Position = { 147, 47 },
    Size = { 120, 16 }
  };

  ControlLayout['Projector Name'] = {
    Style = 'Text',
    Position = { 147, 79 },
    Size = { 120, 16 }
  };
  ControlLayout['Manufacturer'] = {
    Style = 'Text',
    Position = { 147, 95 },
    Size = { 120, 16 }
  };
  ControlLayout['Product Name'] = {
    Style = 'Text',
    Position = { 147, 111 },
    Size = { 120, 16 }
  };
  ControlLayout['Lamp Hours'] = {
    Style = 'Text',
    Position = { 147, 127 },
    Size = { 120, 16 }
  };
  ControlLayout['Extra Info'] = {
    Style = 'Text',
    Position = { 147, 143 },
    Size = { 120, 16 }
  };

  ControlLayout['Power'] = {
    Style = 'Button',
    ButtonStyle = 'Toggle',
    Legend = 'Power',
    Position = { 147, 175 },
    Size = { 105, 16 }
  }
  ControlLayout['Power Status'] = {
    Style = 'LED',
    Color = { 0, 255, 0 },
    Position = { 251, 175 },
    Size = { 16, 16 }
  }
  ControlLayout['AV Mute'] = {
    Style = 'Button',
    ButtonStyle = 'Toggle',
    Legend = 'AV Mute',
    Position = { 147, 191 },
    Size = { 105, 16 }
  }
  ControlLayout['AVMute Status'] = {
    Style = 'LED',
    Position = { 251, 191 },
    Size = { 16, 16 }
  }
  ControlLayout['Operational Status'] = {
    Style = 'Text',
    Position = { 147, 207 },
    Size = { 120, 16 }
  };

  ControlLayout['Input'] = {
    Style = 'ComboBox',
    Position = { 147, 239 },
    Size = { 120, 16 },
    HTextAlign = 'Center'
  };
  ControlLayout['Current Input'] = {
    Style = 'Text',
    Position = { 147, 255 },
    Size = { 120, 16 }
  };

  ControlLayout['Fan Status'] = {
    Style = 'Text',
    Position = { 147, 287 },
    Size = { 120, 16 }
  };
  ControlLayout['Lamp Status'] = {
    Style = 'Text',
    Position = { 147, 303 },
    Size = { 120, 16 }
  };
  ControlLayout['Temp Status'] = {
    Style = 'Text',
    Position = { 147, 319 },
    Size = { 120, 16 }
  };
  ControlLayout['Cover Status'] = {
    Style = 'Text',
    Position = { 147, 335 },
    Size = { 120, 16 }
  };
  ControlLayout['Filter Status'] = {
    Style = 'Text',
    Position = { 147, 351 },
    Size = { 120, 16 }
  };
  ControlLayout['Other Status'] = {
    Style = 'Text',
    Position = { 147, 367 },
    Size = { 120, 16 }
  };

  local GraphicsLayout = {
    {
      Type = 'GroupBox',
      Fill = bgColor,
      StrokeWidth = 1,
      Position = {-6,-6},
      Size = {293,407},
      CornerRadius = 8
    },
    {
      Type = 'Label',
      Text = ':',
      TextSize = 12,
      Position = { 223, 15 },
      Size = { 8, 16 }
    }
  }

  -- Labels for PJLink controls
  for i,label in pairs({
    'IP Address : Port',
    'Password',
    'Connection Status',
    '',
    'Projector Name',
    'Manufacturer',
    'Product Name',
    'Lamp Hours',
    'Extra Info',
    '',
    'Power',
    'AV Mute',
    'Operational Status',
    '',
    'Input Select',
    'Current Input',
    '',
    'Fan Status',
    'Lamp Status',
    'Temp Status',
    'Cover Status',
    'Filter Status',
    'Other Status'
  }) do
    if(label ~= '') then 
      GraphicsLayout[#GraphicsLayout+1] = {
        Type = 'Label',
        Text = label,
        TextSize = 12,
        HTextAlign = 'Left',
        Position = { 15, 15 + 16*(i-1) },
        Size = { 128, 16 }
      };
    end;
  end;

  -- Custom input labels
  local ExtendedGraphicsLayout = {
    
  };

  -- Custom input labels
  if(props['Customise Inputs'].Value) then
    GraphicsLayout[#GraphicsLayout+1] = {
      Type = 'GroupBox',
      Text = 'Customisable Input Names',
      HTextAlign = 'Right',
      Fill = bgColor,
      StrokeWidth = 1,
      Position = { 295, -6 },
      Size = { 374, 407 },
      CornerRadius = 8
    };
    for i=0,44 do

      local typeCode = math.floor(i/9);
      local label = ''
        .. (typeCode==0 and 'RGB ' or '')
        .. (typeCode==1 and 'Video ' or '')
        .. (typeCode==2 and 'Digital ' or '')
        .. (typeCode==3 and 'Storage ' or '')
        .. (typeCode==4 and 'Network ' or '')
        .. (i % 9 + 1);
      GraphicsLayout[#GraphicsLayout + 1] = {
        Type = 'Label',
        Text = label,
        TextSize = 12,
        HTextAlign = 'Right',
        Size = { 56, 16 },
        Position = { i<=22 and 305 or 493, i<=22 and 15+i*16 or 15+(i-22)*16 }
      }

      ControlLayout['Input Nicknames ' ..(i+1)] = {
        Style = 'Text',
        Position = { i<=22 and 361 or 549, i<=22 and 15+i*16 or 15+(i-22)*16 },
        Size = { 96, 16 };
      }

    end;
  end;

  return ControlLayout, GraphicsLayout;

end;

if(Controls) then

  if(Controls['Port'].String == '') then
    Controls['Port'].String = 4352;
  end;

 SOCKET = TcpSocket.New(); 
  SOCKET.ReconnectTimeout = 1;
  SOCKET.ReadTimeout = 10;
  AUTHENTICATED = false;

  -- md5
  if(_VERSION=="Lua 5.3") then
    md5 = Qlib.md5
  else
    md5 = System.IsEmulating
      and load(bitstring.fromhexstream('1b4c7561520001040404080019930d0a1a0a010000005c010000010048aa000000460040004740c0008600400087804001c6004000c7c0c0010601400007014102460140004741c102840180020683410046c34100810302001dc380011b03000017c002808743c206c783c20607c4c2064704c3068744c306c782c306800200094002800800020008c00180078001000717800c8086834100c6c3410001c403009dc3800140038007000300071b0300001700068007c2c206a5030000e5430000000480074744c2061d840001400480078784c2065d84000180048007c704c3069d84000140020009c001800880010008000480074744c3061d840001400480078784c3065d840001c002800880020008d783048017400480a5830000e5c300000404000065040100000280086544010000048008658401008001800865c40100c00180086504020040028008654402008002800865840200c0028008d7c3ff7fa5c30200e50303002544030065840300a5c40300e5040400254504004b05801081050400c14504000186040041c6040081060500c14605000187050041c7050081070600c14706000188060041c8060081080700c14807000189070041c9070081090800c1490800018a080041ca0800810a0900c14a0900018b090041cb0900810b0a00c14b0a00018c0a0041cc0a00810c0b00c14c0b00018d0b0041cd0b00810d0c00c14d0c00018e0c0041ce0c00810e0d00c14e0d00018f0d0041cf0d00810f0e00c14f0e0001900e0041d00e0081100f00c1500f0001910f0041d10f0081111000c15110006445001981851000c1c51000010611004146110081861100c1c61100010712004147120081871200c1c71200010813004148130081881300c1c81300010914004149140081891400c1c9140064850009a5850400e5c504002506050065460500a5860500e5c60500250706004007000e800700005e0700015f0700001f008000540000000407000000737472696e670004050000006368617200040500000062797465000407000000666f726d61740004040000007265700004040000007375620004060000007063616c6c00040800000072657175697265000404000000626974000404000000626f7200040500000062616e64000405000000626e6f7400040500000062786f720004070000007273686966740004070000006c7368696674000406000000626974333200030000008f54edea41030000c0eaf618ed41030000806d3810c241030000c0ddb937e841030000e0f581afee41030000808af1e1d14103000060c20806e54103000020a0d2a8ef4103000000362660da41030000e0f59e68e1410300002076ebffef41030000c0f79a2be141030000804804e4da4103000060320eb3ef41030000c07128cfe4410300004008026dd24103000040acc4c3ee4103000000681608e84103000080282d2fc34103000040f5d836ed41030000a00be2c5ea410300000098a220824103000020d03c14eb4103000000797ffaec4103000000f3e6f0c041030000c0fae066e841030000e0b0a19aee41030000403b8556d141030000a0207d3ce541030000007ff49def4103000040b6c0dbd941030000409149a5e141030000402847ffef4103000020d03eeee04103000080485867db410300008001a7bcef410300008048dd97e44103000040eab3f7d241030000006c69d7ee41030000008ef7d7e7410300000063bf4dc44103000040ff2454ed41030000a010e69dea4103000000147420924103000020079a3aeb41030000a03c73dbec4103000000f87ca2bf41030000a0cc8a95e84103000080482485ee41030000c0e5bfcad041030000e0748472e54103000020077492ef41030000c070d656d941030000409299e1e141030000a08ffefdef4103000020ba8bb0e041030000c0931feadb4103000000dc9cc5ef4103000080622860e44103000040680482d34103000040d06feaee41030000a0465ea7e741030000805de96bc5410300002072da70ed4103000040c048d1d9410300002071b5f9ed41030000c09f5b17e34103000000765432b0411900000012000000140000000100030b0000001a004000174000805c4000001700018045000000800000005d8000014d40c000530080005f0000011f00800002000000030000c0ffffffdf4103000000000000f03f00000000010000000108020000003d000b000000130000001300000013000000130000001300000013000000130000001300000013000000130000001400000001000000020000006e00000000000b00000001000000080000006269745f6e6f7400160000001800000001000203000000650000005f0000011f008000000000000100000017000000170000000200070c00000085000000c500800005010000400100001d81000145010000800180005d010001dd0000009e0000009f0000001f00800000000000000000000200000000000100020000003d000c00000017000000170000001700000017000000170000001700000017000000170000001700000017000000170000001700000002000000020000006100000000000c000000020000006200000000000c0000000200000006000000746f6269740002000000660001000000010e020000003d00030000001700000017000000180000000100000002000000660000000000030000000100000006000000746f626974001f000000270000000100080d0000004100000081400000c14000001501000041410000e1c00080c7810100cf8180034dc081008f804001e080fe7f5f0000011f0080000300000003000000000000000003000000000000f03f0300000000000000400000000000000000020000003d000d00000020000000210000002200000022000000220000002200000023000000230000002300000024000000220000002600000027000000070000000400000074626c00000000000d00000007000000726573756c7400010000000d00000006000000706f77657200020000000d0000000c00000028666f7220696e6465782900050000000b0000000c00000028666f72206c696d69742900050000000b0000000b00000028666f7220737465702900050000000b000000020000006900060000000a0000000000000029000000320000000200081100000080000000c00080001501000155018001194001021780008000018001c000000180000002150180010d014002550100018101000021010080ca40c0032041ff7f1f0080000200000003000000000000f03f0300000000000000000000000000000000020000003d00110000002a0000002a0000002b0000002b0000002b0000002b0000002c0000002c0000002c0000002f0000002f0000002f0000002f0000002f000000300000002f00000032000000080000000300000074310000000000110000000300000074320000000000110000000400000062696700020000001100000006000000736d616c6c0002000000110000000c00000028666f7220696e64657829000d000000100000000c00000028666f72206c696d697429000d000000100000000b00000028666f72207374657029000d000000100000000200000069000e0000000f0000000000000036000000410000000100081800000045000000800000005d8000018600c00087404001d5008000018100009d808001c1c000000001000141c10000e1400180c781810018c0c003174000804a004103170000804ac04003e000fe7fc500000100018000de000001df0000001f0080000500000004050000006d6174680004040000006d61780003000000000000404003000000000000f03f030000000000000000000000000300000001100000010e020000003d00180000003700000037000000370000003800000038000000380000003800000038000000390000003900000039000000390000003a0000003a0000003a0000003b0000003b0000003d00000039000000400000004000000040000000400000004100000007000000020000006e0000000000180000000400000074626c0003000000180000000500000073697a650008000000180000000c00000028666f7220696e64657829000b000000130000000c00000028666f72206c696d697429000b000000130000000b00000028666f72207374657029000b000000130000000200000069000c000000120000000300000008000000746f5f6269747300050000005f454e56000b00000074626c326e756d6265720044000000550000000100051900000019004000174002804500000085008000c6404001c780c00100010000dd0000019d8000008dc040015e0000015f0000004b00000081c00000c40000001900008017400180d10041004ac000010ec10000100041028dc0400117c0fd7f5f0000011f0080000500000003000000000000000004050000006d6174680004040000006162730003000000000000f03f0300000000000000400000000003000000011001080000020000003d00190000004500000045000000470000004700000047000000470000004700000047000000470000004700000047000000470000004a0000004b0000004c0000004d0000004d0000004e0000004f00000050000000500000005100000051000000540000005500000004000000020000006e0000000000190000000400000074626c000d0000001900000004000000636e74000e00000019000000050000006c617374000f000000190000000300000008000000746f5f6269747300080000006269745f6e6f7400050000005f454e5600570000006600000002000a1e00000085000000c00000009d800001c500000000018000dd8000010501800040010001800180011d4180010b0100004101000095010001c101000061010280470202011840c00417000180470282011840c004174000800a414004170000800a0140046041fd7f45010001800100025e0100015f0100001f0080000200000003000000000000f03f03000000000000000000000000030000000110010f010e020000003d001e0000005800000058000000580000005900000059000000590000005a0000005a0000005a0000005a0000005c0000005d0000005d0000005d0000005d0000005e0000005e0000005e0000005e0000005e0000005e0000005f0000005f000000610000005d000000650000006500000065000000650000006600000009000000020000006d00000000001e000000020000006e00000000001e0000000600000074626c5f6d00030000001e0000000600000074626c5f6e00060000001e0000000400000074626c000b0000001e0000000c00000028666f7220696e64657829000e000000190000000c00000028666f72206c696d697429000e000000190000000b00000028666f72207374657029000e000000190000000200000069000f000000180000000300000008000000746f5f626974730007000000657870616e64000b00000074626c326e756d62657200680000007700000002000a1e00000085000000c00000009d800001c500000000018000dd8000010501800040010001800180011d4180010b0100004101000095010001c101000061010280470202015840c00417800080470282011840c004174000800a414004170000800a0140046041fd7f45010001800100025e0100015f0100001f0080000200000003000000000000f03f03000000000000000000000000030000000110010f010e020000003d001e0000006900000069000000690000006a0000006a0000006a0000006b0000006b0000006b0000006b0000006d0000006e0000006e0000006e0000006e0000006f0000006f0000006f0000006f0000006f0000006f0000007000000070000000720000006e000000760000007600000076000000760000007700000009000000020000006d00000000001e000000020000006e00000000001e0000000600000074626c5f6d00030000001e0000000600000074626c5f6e00060000001e0000000400000074626c000b0000001e0000000c00000028666f7220696e64657829000e000000190000000c00000028666f72206c696d697429000e000000190000000b00000028666f72207374657029000e000000190000000200000069000f000000180000000300000008000000746f5f626974730007000000657870616e64000b00000074626c326e756d62657200790000008800000002000b1c00000085000000c00000009d800001c500000000018000dd8000010501800040010001800180011d4180010b0100004101000095010001c101000061810180470202018702820158808204174000800a014004170000800a41400460c1fd7f45010001800100025e0100015f0100001f0080000200000003000000000000f03f03000000000000000000000000030000000110010f010e020000003d001c0000007a0000007a0000007a0000007b0000007b0000007b0000007c0000007c0000007c0000007c0000007e0000007f0000007f0000007f0000007f000000800000008000000080000000800000008100000081000000830000007f000000870000008700000087000000870000008800000009000000020000006d00000000001c000000020000006e00000000001c0000000600000074626c5f6d00030000001c0000000600000074626c5f6e00060000001c0000000400000074626c000b0000001c0000000c00000028666f7220696e64657829000e000000170000000c00000028666f72206c696d697429000e000000170000000b00000028666f72207374657029000e000000170000000200000069000f000000160000000300000008000000746f5f626974730007000000657870616e64000b00000074626c326e756d626572008a0000009900000002000b1f000000810000001900400017c00180c50000000641c00007814002400100001d010001dd8000000dc0c00181000100c640c000c740c10101c100004001800081c1000021c10180108041000502000140028001800200005d820001800200011d828001000000042081fd7f00018001400100001e0100011f0100001f0080000700000003000000000000000004050000006d6174680004040000006162730003000000000000f03f03000000000000e0410406000000666c6f6f72000300000000000000400000000003000000010800000106020000003d001f0000008b0000008c0000008c0000008e0000008e0000008e0000008e0000008e0000008e0000008e0000008f000000920000009200000094000000940000009400000094000000950000009600000096000000960000009600000096000000960000009600000094000000980000009800000098000000980000009900000008000000020000006e00000000001f000000050000006269747300000000001f00000009000000686967685f62697400010000001f00000006000000666c6f6f72000d0000001f0000000c00000028666f7220696e6465782900100000001a0000000c00000028666f72206c696d69742900100000001a0000000b00000028666f7220737465702900100000001a000000020000006900110000001900000003000000080000006269745f6e6f7400050000005f454e5600070000006269745f6f72009b000000a500000002000615000000190040001780018085000000c640c000c780c00100010000dd0000019d8000000dc0400181c00000c000800001c10000a10000800f004100a040ff7f85000001c0000000014101009e0080019f0000001f0080000600000003000000000000000004050000006d6174680004040000006162730003000000000000f03f030000000000000040030000e0ffffffef410000000003000000010800000107020000003d00150000009c0000009c0000009e0000009e0000009e0000009e0000009e0000009e0000009e000000a1000000a1000000a1000000a1000000a2000000a1000000a4000000a4000000a4000000a4000000a4000000a500000006000000020000006e00000000001500000005000000626974730000000000150000000c00000028666f7220696e64657829000c0000000f0000000c00000028666f72206c696d697429000c0000000f0000000b00000028666f72207374657029000c0000000f0000000200000069000d0000000e00000003000000080000006269745f6e6f7400050000005f454e5600080000006269745f616e6400aa000000ad000000010007100000006500000080008000c10000009d800001c000800001410000dd80000100018000418100001d8100014001800081c100005d810001964001019f0000011f0080000400000003000000000000000003000000000000204003000000000000304003000000000000384001000000ab000000ab0000000100060b0000004500000085008000c50000010501800140010000dd808001010100009d0080015e0000005f0000001f00800001000000030000000000e06f4000000000040000000000000100020100020000003d000b000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab00000001000000020000007300000000000b00000004000000050000006368617200080000006269745f616e64000b0000006269745f727368696674000200000069000300000001010107010a020000003d0010000000ab000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ad000000020000000200000069000000000010000000020000006600010000001000000003000000050000006368617200080000006269745f616e64000b0000006269745f72736869667400b0000000b600000001000a0e0000004100000081400000d500000001410000a14001808f81c000c50100000002000040028002dd8180014dc00103a000fe7f5f0000011f0080000300000003000000000000000003000000000000f03f03000000000000704000000000010000000102020000003d000e000000b1000000b2000000b2000000b2000000b2000000b3000000b3000000b3000000b3000000b3000000b3000000b2000000b5000000b600000006000000020000007300000000000e000000020000007600010000000e0000000c00000028666f7220696e6465782900040000000c0000000c00000028666f72206c696d69742900040000000c0000000b00000028666f7220737465702900040000000c000000020000006900050000000b00000001000000050000006279746500b9000000bf00000001000a0e0000004100000095000000c140000001810000a14001808fc1c000c50100000002000040028002dd8180014dc00103a000fe7f5f0000011f0080000400000003000000000000000003000000000000f03f03000000000000f0bf03000000000000704000000000010000000102020000003d000e000000ba000000bb000000bb000000bb000000bb000000bc000000bc000000bc000000bc000000bc000000bc000000bb000000be000000bf00000006000000020000007300000000000e000000020000007600010000000e0000000c00000028666f7220696e6465782900040000000c0000000c00000028666f72206c696d69742900040000000c0000000b00000028666f7220737465702900040000000c000000020000006900050000000b00000001000000050000006279746500c2000000ca00000001010f1b000000410000008b000000cb00000026010000e44000000101000055018001810100002181038006424000078240044002000185028000c5020001000300004003800087c381018d8383008e034007dd0200029d0200001d42000007c281014d00820020c1fb7f9f0000011f0080000300000003000000000000f03f04060000007461626c65000407000000696e73657274000000000003000000000001100105020000003d001b000000c3000000c3000000c4000000c4000000c4000000c5000000c5000000c5000000c5000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c7000000c7000000c5000000c9000000ca00000008000000020000007300000000001b000000020000006f00020000001b000000020000007200020000001b000000050000006172677300050000001b0000000c00000028666f7220696e646578290008000000190000000c00000028666f72206c696d6974290008000000190000000b00000028666f72207374657029000800000019000000020000006900090000001800000003000000050000005f454e560008000000737472326c6569000400000073756200cc000000cc000000010004070000004500000085008000c00000009d0000015e0000005f0000001f008000000000000000000002000000010f010e020000003d0007000000cc000000cc000000cc000000cc000000cc000000cc000000cc00000001000000020000007700000000000700000002000000080000007374723262656900080000006c65693273747200ce000000d000000001000508000000450000008600c000c0000000014100009d0080015e0000005f0000001f008000020000000409000000746f6e756d62657200030000000000003040000000000200000001010000020000003d0008000000cf000000cf000000cf000000cf000000cf000000cf000000cf000000d0000000010000000700000068657876616c00000000000800000002000000050000006368617200050000005f454e5600d2000000d5000000010005060000004c004000c1400000050100005dc000025f0000011f008000020000000405000000677375620004030000002e2e0000000000010000000113020000003d0006000000d3000000d3000000d3000000d3000000d4000000d5000000030000000400000068657800000000000600000007000000726573756c74000400000006000000020000005f000400000006000000010000000e0000006865783262696e61727961757800eb000000eb0000000300080d000000c50000000501800040010000800180001d81800145018000930100008e014003c00100015d018001de000000df0000001f0080000100000003000000000000f03f000000000200000001060107020000003d000d000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb00000003000000020000007800000000000d000000020000007900000000000d000000020000007a00000000000d00000002000000070000006269745f6f7200080000006269745f616e6400ec000000ec0000000300080d000000c50000000501800040010000800100011d8180014501800080018000d3010001ce01c0035d018001de000000df0000001f0080000100000003000000000000f03f000000000200000001060107020000003d000d000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec00000003000000020000007800000000000d000000020000007900000000000d000000020000007a00000000000d00000002000000070000006269745f6f7200080000006269745f616e6400ed000000ed00000003000809000000c5000000000100004501000080018000c00100015d018001de000000df0000001f0080000000000000000000010000000109020000003d0009000000ed000000ed000000ed000000ed000000ed000000ed000000ed000000ed000000ed0000000300000002000000780000000000090000000200000079000000000009000000020000007a00000000000900000001000000080000006269745f786f7200ee000000ee0000000300080a000000c5000000000180004501800080010000d3010001ce01c0035d018001de000000df0000001f0080000100000003000000000000f03f000000000200000001090106020000003d000a000000ee000000ee000000ee000000ee000000ee000000ee000000ee000000ee000000ee000000ee00000003000000020000007800000000000a000000020000007900000000000a000000020000007a00000000000a00000002000000080000006269745f786f7200070000006269745f6f7200ef000000f300000008000f1f000000050200004002000080020001c0028001000300025d8200024d4282004d4281044dc28104810200001d82800140000004050280004502000185020000c00280000503800141030000800300031d0380019d820000c00200035d82800185028001c00280000e8381809d0280011d8200000d8200041f0200011f00800002000000030000e0ffffffef41030000000000004040000000000400000001070106010b010a020000003d001f000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f300000008000000020000006600000000001f000000020000006100000000001f000000020000006200000000001f000000020000006300000000001f000000020000006400000000001f000000020000007800000000001f000000020000007300000000001f00000003000000616300000000001f00000004000000080000006269745f616e6400070000006269745f6f72000b0000006269745f6c7368696674000b0000006269745f72736869667400f50000003e010000050013cb0200004001000080018000c0010001000280014502000085028000c5020001000380024003000380038003c003000407044002414400008784c0049d8280044001000585028000c5020001000300044003800280030003c00380030784400241c400008704c1049d8280040002000585028000c5020001000380034003000480038002c003000307044102414401008784c1049d828004c001000585028000c5020001000300034003800380030004c00380020784410241c401008704c2049d8280048001000585028000c5020001000380024003000380038003c003000407044202414400008744c2049d8280044001000585028000c5020001000300044003800280030003c00380030744420241c400008784c2049d8280040002000585028000c5020001000380034003000480038002c003000307844202414401008744c0049d828004c001000585028000c5020001000300034003800380030004c00380020744400241c4010087c4c2049d8280048001000585028000c5020001000380024003000380038003c003000407c44202414400008704c3049d8280044001000585028000c5020001000300044003800280030003c00380030704430241c400008744c3049d8280040002000585028000c5020001000380034003000480038002c003000307444302414401008784c3049d828004c001000585028000c5020001000300034003800380030004c00380020784430241c4010087c4c0049d8280048001000585028000c5020001000380024003000380038003c003000407c440024144000087c4c3049d8280044001000585028000c5020001000300044003800280030003c003800307c4430241c400008704c4049d8280040002000585028000c5020001000380034003000480038002c003000307044402414401008744c4049d828004c001000585028000c5020001000300034003800380030004c00380020744440241c401008784c4049d8280048001000585028000c5028001000380024003000380038003c003000407844002414402008744c1049d8280044001000585028000c5028001000300044003800280030003c0038003078442024104030087c4c4049d8280040002000585028000c5028001000380034003000480038002c003000307844302410404008704c5049d828004c001000585028000c5028001000300034003800380030004c003800207044002414405008744c5049d8280048001000585028000c5028001000380024003000380038003c003000407444202414402008784c5049d8280044001000585028000c5028001000300044003800280030003c0038003074443024104030087c4c1049d8280040002000585028000c5028001000380034003000480038002c0030003074444024104040087c4c5049d828004c001000585028000c5028001000300034003800380030004c003800207044202414405008704c6049d8280048001000585028000c5028001000380024003000380038003c003000407044302414402008744c6049d8280044001000585028000c5028001000300044003800280030003c003800307044402410403008784c6049d8280040002000585028000c5028001000380034003000480038002c0030003078441024104040087c4c6049d828004c001000585028000c5028001000300034003800380030004c003800207c44202414405008704c7049d8280048001000585028000c5028001000380024003000380038003c003000407c44302414402008744c7049d8280044001000585028000c5028001000300044003800280030003c003800307044102410403008784c7049d8280040002000585028000c5028001000380034003000480038002c0030003074440024104040087c4c7049d828004c001000585028000c5028001000300034003800380030004c003800207c44002414405008704c8049d8280048001000585028000c5020002000380024003000380038003c003000407444202410402008744c8049d8280044001000585028000c5020002000300044003800280030003c003800307c44202418403008784c8049d8280040002000585028000c5020002000380034003000480038002c0030003078443024184040087c4c8049d828004c001000585028000c5020002000300034003800380030004c00380020704440241c405008704c9049d8280048001000585028000c5020002000380024003000380038003c003000407844002410402008744c9049d8280044001000585028000c5020002000300044003800280030003c003800307044202418403008784c9049d8280040002000585028000c5020002000380034003000480038002c0030003074440024184040087c4c9049d828004c001000585028000c5020002000300034003800380030004c00380020744430241c405008704ca049d8280048001000585028000c5020002000380024003000380038003c003000407c44302410402008744ca049d8280044001000585028000c5020002000300044003800280030003c003800307044002418403008784ca049d8280040002000585028000c5020002000380034003000480038002c0030003078441024184040087c4ca049d828004c001000585028000c5020002000300034003800380030004c00380020784420241c405008704cb049d8280048001000585028000c5020002000380024003000380038003c003000407044302410402008744cb049d8280044001000585028000c5020002000300044003800280030003c003800307c44002418403008784cb049d8280040002000585028000c5020002000380034003000480038002c0030003074444024184040087c4cb049d828004c001000585028000c5020002000300034003800380030004c00380020704410241c405008704cc049d8280048001000585028000c5028002000380024003000380038003c003000407044002418402008744cc049d8280044001000585028000c5028002000300044003800280030003c003800307444002414403008784cc049d8280040002000585028000c5028002000380034003000480038002c0030003070444024144040087c4cc049d828004c001000585028000c5028002000300034003800380030004c003800207444202418405008704cd049d8280048001000585028000c5028002000380024003000380038003c003000407c44002418402008744cd049d8280044001000585028000c5028002000300044003800280030003c003800307844102414403008784cd049d8280040002000585028000c5028002000380034003000480038002c0030003074443024144040087c4cd049d828004c001000585028000c5028002000300034003800380030004c003800207844002418405008704ce049d8280048001000585028000c5028002000380024003000380038003c003000407c44202418402008744ce049d8280044001000585028000c5028002000300044003800280030003c003800307444402414403008784ce049d8280040002000585028000c5028002000380034003000480038002c0030003078442024144040087c4ce049d828004c001000585028000c5028002000300034003800380030004c003800207c44302418405008704cf049d8280048001000585028000c5028002000380024003000380038003c003000407044202418402008744cf049d8280044001000585028000c5028002000300044003800280030003c003800307844302414403008784cf049d8280040002000585028000c5028002000380034003000480038002c0030003070441024144040087c4cf049d828004c001000585028000c5028002000300034003800380030004c003800207044302418405008704d0049d828004800100058d420100cd8281000dc301014d0382019f0280021f00800041000000030000000000000000030000000000001c4003000000000000f03f030000000000002840030000000000000040030000000000003140030000000000000840030000000000003640030000000000001040030000000000001440030000000000001840030000000000002040030000000000002240030000000000002440030000000000002640030000000000002a40030000000000002c40030000000000002e40030000000000003040030000000000003240030000000000003340030000000000003440030000000000003540030000000000003740030000000000003840030000000000003940030000000000003a40030000000000003b40030000000000003c40030000000000003d40030000000000003e40030000000000003f40030000000000004040030000000000804040030000000000004140030000000000804140030000000000004240030000000000804240030000000000004340030000000000804340030000000000004440030000000000804440030000000000004540030000000000804540030000000000004640030000000000804640030000000000004740030000000000804740030000000000004840030000000000804840030000000000004940030000000000804940030000000000004a40030000000000804a40030000000000004b40030000000000804b40030000000000004c40030000000000804c40030000000000004d40030000000000804d40030000000000004e40030000000000804e40030000000000004f40030000000000804f4003000000000000504000000000060000000115011a0116011701180119020000003d00cb020000f6000000f6000000f6000000f6000000f7000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff0000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000002010000020100000201000002010000020100000201000002010000020100000201000002010000020100000301000003010000030100000301000003010000030100000301000003010000030100000301000003010000040100000401000004010000040100000401000004010000040100000401000004010000040100000401000005010000050100000501000005010000050100000501000005010000050100000501000005010000050100000601000006010000060100000601000006010000060100000601000006010000060100000601000006010000070100000701000007010000070100000701000007010000070100000701000007010000070100000701000008010000080100000801000008010000080100000801000008010000080100000801000008010000080100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f01000010010000100100001001000010010000100100001001000010010000100100001001000010010000100100001101000011010000110100001101000011010000110100001101000011010000110100001101000011010000120100001201000012010000120100001201000012010000120100001201000012010000120100001201000013010000130100001301000013010000130100001301000013010000130100001301000013010000130100001401000014010000140100001401000014010000140100001401000014010000140100001401000014010000150100001501000015010000150100001501000015010000150100001501000015010000150100001501000016010000160100001601000016010000160100001601000016010000160100001601000016010000160100001701000017010000170100001701000017010000170100001701000017010000170100001701000017010000180100001801000018010000180100001801000018010000180100001801000018010000180100001801000019010000190100001901000019010000190100001901000019010000190100001901000019010000190100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f01000020010000200100002001000020010000200100002001000020010000200100002001000020010000200100002101000021010000210100002101000021010000210100002101000021010000210100002101000021010000220100002201000022010000220100002201000022010000220100002201000022010000220100002201000023010000230100002301000023010000230100002301000023010000230100002301000023010000230100002401000024010000240100002401000024010000240100002401000024010000240100002401000024010000250100002501000025010000250100002501000025010000250100002501000025010000250100002501000026010000260100002601000026010000260100002601000026010000260100002601000026010000260100002701000027010000270100002701000027010000270100002701000027010000270100002701000027010000280100002801000028010000280100002801000028010000280100002801000028010000280100002801000029010000290100002901000029010000290100002901000029010000290100002901000029010000290100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f01000030010000300100003001000030010000300100003001000030010000300100003001000030010000300100003101000031010000310100003101000031010000310100003101000031010000310100003101000031010000320100003201000032010000320100003201000032010000320100003201000032010000320100003201000033010000330100003301000033010000330100003301000033010000330100003301000033010000330100003401000034010000340100003401000034010000340100003401000034010000340100003401000034010000350100003501000035010000350100003501000035010000350100003501000035010000350100003501000036010000360100003601000036010000360100003601000036010000360100003601000036010000360100003701000037010000370100003701000037010000370100003701000037010000370100003701000037010000380100003801000038010000380100003801000038010000380100003801000038010000380100003801000039010000390100003901000039010000390100003901000039010000390100003901000039010000390100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003d0100003d0100003d0100003d0100003d0100003e0100000a00000002000000410000000000cb02000002000000420000000000cb02000002000000430000000000cb02000002000000440000000000cb02000002000000580000000000cb02000002000000610004000000cb02000002000000620004000000cb02000002000000630004000000cb02000002000000640004000000cb02000002000000740005000000cb0200000600000007000000434f4e53545300020000007a00020000006600020000006700020000006800020000006900420100005901000001001e6d000000550000009100c0008e808080d100c00019c08080170000808d004001188040011700008081000000c00000000501000041c100001d8100014501800085010000c18100009d810001ce0141015d81800185010001cf4180829d810001c501000101820000dd81000116c08101c680c101150100001101400258804002170000800341000003018000dd400001c500000207c1c1014701c2018741c201c781c20101020100550200008102000021820b80050380024503000380030000c00380050dc4c2055d83000281030300c1030300010403004104030081040300c1040300010503004105030081050300c1050300010603004106030081060300c106030001070300410703001d8300094683c10195030006584043071700008083430000830380005d4300014683c30147c3c30680030006c10301005d8380010a4303814503800380030002c00380020004000340048003800400065d430103c001000880018007400100070001800620c2f37f050200044102040085028004c00200029d820001c502800400038002dd82000105038004400300031d83000145038004800380035d0300011e0200001f0200001f00800011000000030000000000005040030000000000004c4003000000000000000003000000000000604003000000000000f03f030000000000002040040700000061737365727400030000000000405040030000000000805040030000000000c05040030000000000005140030000000000804f4003000000000000104003000000000000304004060000007461626c6500040700000072656d6f76650004110000002530387825303878253038782530387800000000000a00000001010104010e0000011501110105011b01030112020000003d006d000000430100004401000044010000460100004601000046010000460100004801000048010000480100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004c0100004c0100004c0100004c0100004c0100004c0100004c0100004c0100004e0100004f0100004f0100004f0100004f0100005101000051010000510100005101000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005301000053010000530100005301000053010000530100005301000054010000540100005401000054010000540100005401000055010000550100005501000055010000550100005501000055010000550100005501000055010000550100005101000058010000580100005801000058010000580100005801000058010000580100005801000058010000580100005801000058010000580100005801000058010000590100000d000000020000007300000000006d000000070000006d73674c656e00010000006d000000070000007061644c656e00030000006d000000020000007400240000006d000000020000006100280000006d000000020000006200280000006d000000020000006300280000006d000000020000006400280000006d0000000c00000028666f7220696e64657829002b0000005c0000000c00000028666f72206c696d697429002b0000005c0000000b00000028666f72207374657029002b0000005c0000000200000069002c0000005b000000020000005800430000005b0000000a0000000500000063686172000400000072657000080000006c65693273747200050000005f454e560007000000434f4e535453000b0000006375745f6c655f7374720004000000737562000a0000007472616e73666f726d0007000000666f726d617400050000007377617000010000000000020000003d00aa00000005000000050000000500000005000000050000000500000005000000050000000500000005000000060000000800000008000000080000000800000009000000090000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000c0000000c0000000c0000000c0000000c0000000c0000000e0000000e0000001000000014000000180000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001b0000001b0000001b0000001b0000001b0000001b0000001b0000001b0000001b0000001b000000270000003200000034000000410000004100000055000000550000006600000066000000770000007700000088000000880000009900000099000000a5000000a5000000a5000000ad000000b6000000bf000000ca000000cc000000d0000000d5000000d7000000d8000000d8000000d8000000d8000000d9000000d9000000d9000000d9000000da000000da000000da000000da000000db000000db000000db000000db000000dc000000dc000000dc000000dc000000dd000000dd000000dd000000dd000000de000000de000000de000000de000000df000000df000000df000000df000000e0000000e0000000e0000000e0000000e1000000e1000000e1000000e1000000e2000000e2000000e2000000e2000000e3000000e3000000e3000000e3000000e4000000e4000000e4000000e4000000e4000000e5000000e5000000e5000000e5000000e6000000e6000000e6000000e6000000e7000000e7000000e7000000e7000000e8000000e8000000e8000000e9000000e9000000eb000000ec000000ed000000ee000000f30000003e010000590100005b0100005b0100005b0100005b0100005c01000022000000080000007375626a6563740000000000aa0000000500000063686172000a000000aa0000000500000062797465000a000000aa00000007000000666f726d6174000a000000aa00000004000000726570000a000000aa00000004000000737562000a000000aa000000070000006269745f6f72000b000000aa000000080000006269745f616e64000b000000aa000000080000006269745f6e6f74000b000000aa000000080000006269745f786f72000b000000aa0000000b0000006269745f727368696674000b000000aa0000000b0000006269745f6c7368696674000b000000aa000000030000006f6b000f000000aa00000004000000626974000f000000aa00000006000000746f62697400270000003d0000000a0000006e6f726d616c697a6500280000003d0000000b00000074626c326e756d626572003f0000005000000007000000657870616e6400400000005000000008000000746f5f62697473004100000050000000080000006c6569327374720051000000aa00000008000000737472326265690052000000aa00000008000000737472326c65690053000000aa0000000b0000006375745f6c655f7374720054000000aa00000005000000737761700055000000aa0000000e0000006865783262696e6172796175780056000000aa0000000b0000006865783262696e6172790057000000aa00000007000000434f4e535453009e000000aa0000000200000066009f000000aa000000020000006700a0000000aa000000020000006800a1000000aa000000020000006900a2000000aa000000020000007a00a3000000aa0000000a0000007472616e73666f726d00a4000000aa0000000800000073756d6865786100a5000000aa00000001000000050000005f454e5600'))
      or load(bitstring.fromhexstream('1b4c7561520001040804080019930d0a1a0a010000005c010000010048aa000000460040004740c0008600400087804001c6004000c7c0c0010601400007014102460140004741c102840180020683410046c34100810302001dc380011b03000017c002808743c206c783c20607c4c2064704c3068744c306c782c306800200094002800800020008c00180078001000717800c8086834100c6c3410001c403009dc3800140038007000300071b0300001700068007c2c206a5030000e5430000000480074744c2061d840001400480078784c2065d84000180048007c704c3069d84000140020009c001800880010008000480074744c3061d840001400480078784c3065d840001c002800880020008d783048017400480a5830000e5c300000404000065040100000280086544010000048008658401008001800865c40100c00180086504020040028008654402008002800865840200c0028008d7c3ff7fa5c30200e50303002544030065840300a5c40300e5040400254504004b05801081050400c14504000186040041c6040081060500c14605000187050041c7050081070600c14706000188060041c8060081080700c14807000189070041c9070081090800c1490800018a080041ca0800810a0900c14a0900018b090041cb0900810b0a00c14b0a00018c0a0041cc0a00810c0b00c14c0b00018d0b0041cd0b00810d0c00c14d0c00018e0c0041ce0c00810e0d00c14e0d00018f0d0041cf0d00810f0e00c14f0e0001900e0041d00e0081100f00c1500f0001910f0041d10f0081111000c15110006445001981851000c1c51000010611004146110081861100c1c61100010712004147120081871200c1c71200010813004148130081881300c1c81300010914004149140081891400c1c9140064850009a5850400e5c504002506050065460500a5860500e5c60500250706004007000e800700005e0700015f0700001f00800054000000040700000000000000737472696e670004050000000000000063686172000405000000000000006279746500040700000000000000666f726d61740004040000000000000072657000040400000000000000737562000406000000000000007063616c6c00040800000000000000726571756972650004040000000000000062697400040400000000000000626f720004050000000000000062616e6400040500000000000000626e6f740004050000000000000062786f7200040700000000000000727368696674000407000000000000006c736869667400040600000000000000626974333200030000008f54edea41030000c0eaf618ed41030000806d3810c241030000c0ddb937e841030000e0f581afee41030000808af1e1d14103000060c20806e54103000020a0d2a8ef4103000000362660da41030000e0f59e68e1410300002076ebffef41030000c0f79a2be141030000804804e4da4103000060320eb3ef41030000c07128cfe4410300004008026dd24103000040acc4c3ee4103000000681608e84103000080282d2fc34103000040f5d836ed41030000a00be2c5ea410300000098a220824103000020d03c14eb4103000000797ffaec4103000000f3e6f0c041030000c0fae066e841030000e0b0a19aee41030000403b8556d141030000a0207d3ce541030000007ff49def4103000040b6c0dbd941030000409149a5e141030000402847ffef4103000020d03eeee04103000080485867db410300008001a7bcef410300008048dd97e44103000040eab3f7d241030000006c69d7ee41030000008ef7d7e7410300000063bf4dc44103000040ff2454ed41030000a010e69dea4103000000147420924103000020079a3aeb41030000a03c73dbec4103000000f87ca2bf41030000a0cc8a95e84103000080482485ee41030000c0e5bfcad041030000e0748472e54103000020077492ef41030000c070d656d941030000409299e1e141030000a08ffefdef4103000020ba8bb0e041030000c0931feadb4103000000dc9cc5ef4103000080622860e44103000040680482d34103000040d06feaee41030000a0465ea7e741030000805de96bc5410300002072da70ed4103000040c048d1d9410300002071b5f9ed41030000c09f5b17e34103000000765432b0411900000012000000140000000100030b0000001a004000174000805c4000001700018045000000800000005d8000014d40c000530080005f0000011f00800002000000030000c0ffffffdf4103000000000000f03f0000000001000000010802000000000000003d000b00000013000000130000001300000013000000130000001300000013000000130000001300000013000000140000000100000002000000000000006e00000000000b0000000100000008000000000000006269745f6e6f7400160000001800000001000203000000650000005f0000011f008000000000000100000017000000170000000200070c00000085000000c500800005010000400100001d81000145010000800180005d010001dd0000009e0000009f0000001f0080000000000000000000020000000000010002000000000000003d000c0000001700000017000000170000001700000017000000170000001700000017000000170000001700000017000000170000000200000002000000000000006100000000000c00000002000000000000006200000000000c000000020000000600000000000000746f626974000200000000000000660001000000010e02000000000000003d000300000017000000170000001800000001000000020000000000000066000000000003000000010000000600000000000000746f626974001f000000270000000100080d0000004100000081400000c14000001501000041410000e1c00080c7810100cf8180034dc081008f804001e080fe7f5f0000011f0080000300000003000000000000000003000000000000f03f030000000000000040000000000000000002000000000000003d000d0000002000000021000000220000002200000022000000220000002300000023000000230000002400000022000000260000002700000007000000040000000000000074626c00000000000d0000000700000000000000726573756c7400010000000d0000000600000000000000706f77657200020000000d0000000c0000000000000028666f7220696e6465782900050000000b0000000c0000000000000028666f72206c696d69742900050000000b0000000b0000000000000028666f7220737465702900050000000b00000002000000000000006900060000000a0000000000000029000000320000000200081100000080000000c00080001501000155018001194001021780008000018001c000000180000002150180010d014002550100018101000021010080ca40c0032041ff7f1f0080000200000003000000000000f03f030000000000000000000000000000000002000000000000003d00110000002a0000002a0000002b0000002b0000002b0000002b0000002c0000002c0000002c0000002f0000002f0000002f0000002f0000002f000000300000002f0000003200000008000000030000000000000074310000000000110000000300000000000000743200000000001100000004000000000000006269670002000000110000000600000000000000736d616c6c0002000000110000000c0000000000000028666f7220696e64657829000d000000100000000c0000000000000028666f72206c696d697429000d000000100000000b0000000000000028666f72207374657029000d00000010000000020000000000000069000e0000000f0000000000000036000000410000000100081800000045000000800000005d8000018600c00087404001d5008000018100009d808001c1c000000001000141c10000e1400180c781810018c0c003174000804a004103170000804ac04003e000fe7fc500000100018000de000001df0000001f008000050000000405000000000000006d617468000404000000000000006d61780003000000000000404003000000000000f03f030000000000000000000000000300000001100000010e02000000000000003d00180000003700000037000000370000003800000038000000380000003800000038000000390000003900000039000000390000003a0000003a0000003a0000003b0000003b0000003d0000003900000040000000400000004000000040000000410000000700000002000000000000006e000000000018000000040000000000000074626c000300000018000000050000000000000073697a650008000000180000000c0000000000000028666f7220696e64657829000b000000130000000c0000000000000028666f72206c696d697429000b000000130000000b0000000000000028666f72207374657029000b00000013000000020000000000000069000c00000012000000030000000800000000000000746f5f626974730005000000000000005f454e56000b0000000000000074626c326e756d6265720044000000550000000100051900000019004000174002804500000085008000c6404001c780c00100010000dd0000019d8000008dc040015e0000015f0000004b00000081c00000c40000001900008017400180d10041004ac000010ec10000100041028dc0400117c0fd7f5f0000011f008000050000000300000000000000000405000000000000006d617468000404000000000000006162730003000000000000f03f030000000000000040000000000300000001100108000002000000000000003d00190000004500000045000000470000004700000047000000470000004700000047000000470000004700000047000000470000004a0000004b0000004c0000004d0000004d0000004e0000004f0000005000000050000000510000005100000054000000550000000400000002000000000000006e000000000019000000040000000000000074626c000d000000190000000400000000000000636e74000e0000001900000005000000000000006c617374000f00000019000000030000000800000000000000746f5f626974730008000000000000006269745f6e6f740005000000000000005f454e5600570000006600000002000a1e00000085000000c00000009d800001c500000000018000dd8000010501800040010001800180011d4180010b0100004101000095010001c101000061010280470202011840c00417000180470282011840c004174000800a414004170000800a0140046041fd7f45010001800100025e0100015f0100001f0080000200000003000000000000f03f03000000000000000000000000030000000110010f010e02000000000000003d001e0000005800000058000000580000005900000059000000590000005a0000005a0000005a0000005a0000005c0000005d0000005d0000005d0000005d0000005e0000005e0000005e0000005e0000005e0000005e0000005f0000005f000000610000005d00000065000000650000006500000065000000660000000900000002000000000000006d00000000001e00000002000000000000006e00000000001e000000060000000000000074626c5f6d00030000001e000000060000000000000074626c5f6e00060000001e000000040000000000000074626c000b0000001e0000000c0000000000000028666f7220696e64657829000e000000190000000c0000000000000028666f72206c696d697429000e000000190000000b0000000000000028666f72207374657029000e00000019000000020000000000000069000f00000018000000030000000800000000000000746f5f62697473000700000000000000657870616e64000b0000000000000074626c326e756d62657200680000007700000002000a1e00000085000000c00000009d800001c500000000018000dd8000010501800040010001800180011d4180010b0100004101000095010001c101000061010280470202015840c00417800080470282011840c004174000800a414004170000800a0140046041fd7f45010001800100025e0100015f0100001f0080000200000003000000000000f03f03000000000000000000000000030000000110010f010e02000000000000003d001e0000006900000069000000690000006a0000006a0000006a0000006b0000006b0000006b0000006b0000006d0000006e0000006e0000006e0000006e0000006f0000006f0000006f0000006f0000006f0000006f0000007000000070000000720000006e00000076000000760000007600000076000000770000000900000002000000000000006d00000000001e00000002000000000000006e00000000001e000000060000000000000074626c5f6d00030000001e000000060000000000000074626c5f6e00060000001e000000040000000000000074626c000b0000001e0000000c0000000000000028666f7220696e64657829000e000000190000000c0000000000000028666f72206c696d697429000e000000190000000b0000000000000028666f72207374657029000e00000019000000020000000000000069000f00000018000000030000000800000000000000746f5f62697473000700000000000000657870616e64000b0000000000000074626c326e756d62657200790000008800000002000b1c00000085000000c00000009d800001c500000000018000dd8000010501800040010001800180011d4180010b0100004101000095010001c101000061810180470202018702820158808204174000800a014004170000800a41400460c1fd7f45010001800100025e0100015f0100001f0080000200000003000000000000f03f03000000000000000000000000030000000110010f010e02000000000000003d001c0000007a0000007a0000007a0000007b0000007b0000007b0000007c0000007c0000007c0000007c0000007e0000007f0000007f0000007f0000007f000000800000008000000080000000800000008100000081000000830000007f00000087000000870000008700000087000000880000000900000002000000000000006d00000000001c00000002000000000000006e00000000001c000000060000000000000074626c5f6d00030000001c000000060000000000000074626c5f6e00060000001c000000040000000000000074626c000b0000001c0000000c0000000000000028666f7220696e64657829000e000000170000000c0000000000000028666f72206c696d697429000e000000170000000b0000000000000028666f72207374657029000e00000017000000020000000000000069000f00000016000000030000000800000000000000746f5f62697473000700000000000000657870616e64000b0000000000000074626c326e756d626572008a0000009900000002000b1f000000810000001900400017c00180c50000000641c00007814002400100001d010001dd8000000dc0c00181000100c640c000c740c10101c100004001800081c1000021c10180108041000502000140028001800200005d820001800200011d828001000000042081fd7f00018001400100001e0100011f0100001f008000070000000300000000000000000405000000000000006d617468000404000000000000006162730003000000000000f03f03000000000000e041040600000000000000666c6f6f7200030000000000000040000000000300000001080000010602000000000000003d001f0000008b0000008c0000008c0000008e0000008e0000008e0000008e0000008e0000008e0000008e0000008f00000092000000920000009400000094000000940000009400000095000000960000009600000096000000960000009600000096000000960000009400000098000000980000009800000098000000990000000800000002000000000000006e00000000001f00000005000000000000006269747300000000001f0000000900000000000000686967685f62697400010000001f0000000600000000000000666c6f6f72000d0000001f0000000c0000000000000028666f7220696e6465782900100000001a0000000c0000000000000028666f72206c696d69742900100000001a0000000b0000000000000028666f7220737465702900100000001a0000000200000000000000690011000000190000000300000008000000000000006269745f6e6f740005000000000000005f454e560007000000000000006269745f6f72009b000000a500000002000615000000190040001780018085000000c640c000c780c00100010000dd0000019d8000000dc0400181c00000c000800001c10000a10000800f004100a040ff7f85000001c0000000014101009e0080019f0000001f008000060000000300000000000000000405000000000000006d617468000404000000000000006162730003000000000000f03f030000000000000040030000e0ffffffef41000000000300000001080000010702000000000000003d00150000009c0000009c0000009e0000009e0000009e0000009e0000009e0000009e0000009e000000a1000000a1000000a1000000a1000000a2000000a1000000a4000000a4000000a4000000a4000000a4000000a50000000600000002000000000000006e0000000000150000000500000000000000626974730000000000150000000c0000000000000028666f7220696e64657829000c0000000f0000000c0000000000000028666f72206c696d697429000c0000000f0000000b0000000000000028666f72207374657029000c0000000f000000020000000000000069000d0000000e0000000300000008000000000000006269745f6e6f740005000000000000005f454e560008000000000000006269745f616e6400aa000000ad000000010007100000006500000080008000c10000009d800001c000800001410000dd80000100018000418100001d8100014001800081c100005d810001964001019f0000011f0080000400000003000000000000000003000000000000204003000000000000304003000000000000384001000000ab000000ab0000000100060b0000004500000085008000c50000010501800140010000dd808001010100009d0080015e0000005f0000001f00800001000000030000000000e06f400000000004000000000000010002010002000000000000003d000b000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab000000ab0000000100000002000000000000007300000000000b000000040000000500000000000000636861720008000000000000006269745f616e64000b000000000000006269745f72736869667400020000000000000069000300000001010107010a02000000000000003d0010000000ab000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ac000000ad00000002000000020000000000000069000000000010000000020000000000000066000100000010000000030000000500000000000000636861720008000000000000006269745f616e64000b000000000000006269745f72736869667400b0000000b600000001000a0e0000004100000081400000d500000001410000a14001808f81c000c50100000002000040028002dd8180014dc00103a000fe7f5f0000011f0080000300000003000000000000000003000000000000f03f0300000000000070400000000001000000010202000000000000003d000e000000b1000000b2000000b2000000b2000000b2000000b3000000b3000000b3000000b3000000b3000000b3000000b2000000b5000000b60000000600000002000000000000007300000000000e00000002000000000000007600010000000e0000000c0000000000000028666f7220696e6465782900040000000c0000000c0000000000000028666f72206c696d69742900040000000c0000000b0000000000000028666f7220737465702900040000000c00000002000000000000006900050000000b0000000100000005000000000000006279746500b9000000bf00000001000a0e0000004100000095000000c140000001810000a14001808fc1c000c50100000002000040028002dd8180014dc00103a000fe7f5f0000011f0080000400000003000000000000000003000000000000f03f03000000000000f0bf0300000000000070400000000001000000010202000000000000003d000e000000ba000000bb000000bb000000bb000000bb000000bc000000bc000000bc000000bc000000bc000000bc000000bb000000be000000bf0000000600000002000000000000007300000000000e00000002000000000000007600010000000e0000000c0000000000000028666f7220696e6465782900040000000c0000000c0000000000000028666f72206c696d69742900040000000c0000000b0000000000000028666f7220737465702900040000000c00000002000000000000006900050000000b0000000100000005000000000000006279746500c2000000ca00000001010f1b000000410000008b000000cb00000026010000e44000000101000055018001810100002181038006424000078240044002000185028000c5020001000300004003800087c381018d8383008e034007dd0200029d0200001d42000007c281014d00820020c1fb7f9f0000011f0080000300000003000000000000f03f0406000000000000007461626c6500040700000000000000696e7365727400000000000300000000000110010502000000000000003d001b000000c3000000c3000000c4000000c4000000c4000000c5000000c5000000c5000000c5000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c6000000c7000000c7000000c5000000c9000000ca0000000800000002000000000000007300000000001b00000002000000000000006f00020000001b00000002000000000000007200020000001b00000005000000000000006172677300050000001b0000000c0000000000000028666f7220696e646578290008000000190000000c0000000000000028666f72206c696d6974290008000000190000000b0000000000000028666f722073746570290008000000190000000200000000000000690009000000180000000300000005000000000000005f454e56000800000000000000737472326c656900040000000000000073756200cc000000cc000000010004070000004500000085008000c00000009d0000015e0000005f0000001f008000000000000000000002000000010f010e02000000000000003d0007000000cc000000cc000000cc000000cc000000cc000000cc000000cc00000001000000020000000000000077000000000007000000020000000800000000000000737472326265690008000000000000006c65693273747200ce000000d000000001000508000000450000008600c000c0000000014100009d0080015e0000005f0000001f00800002000000040900000000000000746f6e756d6265720003000000000000304000000000020000000101000002000000000000003d0008000000cf000000cf000000cf000000cf000000cf000000cf000000cf000000d000000001000000070000000000000068657876616c000000000008000000020000000500000000000000636861720005000000000000005f454e5600d2000000d5000000010005060000004c004000c1400000050100005dc000025f0000011f0080000200000004050000000000000067737562000403000000000000002e2e000000000001000000011302000000000000003d0006000000d3000000d3000000d3000000d3000000d4000000d50000000300000004000000000000006865780000000000060000000700000000000000726573756c7400040000000600000002000000000000005f000400000006000000010000000e000000000000006865783262696e61727961757800eb000000eb0000000300080d000000c50000000501800040010000800180001d81800145018000930100008e014003c00100015d018001de000000df0000001f0080000100000003000000000000f03f00000000020000000106010702000000000000003d000d000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb000000eb0000000300000002000000000000007800000000000d00000002000000000000007900000000000d00000002000000000000007a00000000000d0000000200000007000000000000006269745f6f720008000000000000006269745f616e6400ec000000ec0000000300080d000000c50000000501800040010000800100011d8180014501800080018000d3010001ce01c0035d018001de000000df0000001f0080000100000003000000000000f03f00000000020000000106010702000000000000003d000d000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec000000ec0000000300000002000000000000007800000000000d00000002000000000000007900000000000d00000002000000000000007a00000000000d0000000200000007000000000000006269745f6f720008000000000000006269745f616e6400ed000000ed00000003000809000000c5000000000100004501000080018000c00100015d018001de000000df0000001f008000000000000000000001000000010902000000000000003d0009000000ed000000ed000000ed000000ed000000ed000000ed000000ed000000ed000000ed0000000300000002000000000000007800000000000900000002000000000000007900000000000900000002000000000000007a0000000000090000000100000008000000000000006269745f786f7200ee000000ee0000000300080a000000c5000000000180004501800080010000d3010001ce01c0035d018001de000000df0000001f0080000100000003000000000000f03f00000000020000000109010602000000000000003d000a000000ee000000ee000000ee000000ee000000ee000000ee000000ee000000ee000000ee000000ee0000000300000002000000000000007800000000000a00000002000000000000007900000000000a00000002000000000000007a00000000000a0000000200000008000000000000006269745f786f720007000000000000006269745f6f7200ef000000f300000008000f1f000000050200004002000080020001c0028001000300025d8200024d4282004d4281044dc28104810200001d82800140000004050280004502000185020000c00280000503800141030000800300031d0380019d820000c00200035d82800185028001c00280000e8381809d0280011d8200000d8200041f0200011f00800002000000030000e0ffffffef41030000000000004040000000000400000001070106010b010a02000000000000003d001f000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f0000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f2000000f30000000800000002000000000000006600000000001f00000002000000000000006100000000001f00000002000000000000006200000000001f00000002000000000000006300000000001f00000002000000000000006400000000001f00000002000000000000007800000000001f00000002000000000000007300000000001f0000000300000000000000616300000000001f0000000400000008000000000000006269745f616e640007000000000000006269745f6f72000b000000000000006269745f6c7368696674000b000000000000006269745f72736869667400f50000003e010000050013cb0200004001000080018000c0010001000280014502000085028000c5020001000380024003000380038003c003000407044002414400008784c0049d8280044001000585028000c5020001000300044003800280030003c00380030784400241c400008704c1049d8280040002000585028000c5020001000380034003000480038002c003000307044102414401008784c1049d828004c001000585028000c5020001000300034003800380030004c00380020784410241c401008704c2049d8280048001000585028000c5020001000380024003000380038003c003000407044202414400008744c2049d8280044001000585028000c5020001000300044003800280030003c00380030744420241c400008784c2049d8280040002000585028000c5020001000380034003000480038002c003000307844202414401008744c0049d828004c001000585028000c5020001000300034003800380030004c00380020744400241c4010087c4c2049d8280048001000585028000c5020001000380024003000380038003c003000407c44202414400008704c3049d8280044001000585028000c5020001000300044003800280030003c00380030704430241c400008744c3049d8280040002000585028000c5020001000380034003000480038002c003000307444302414401008784c3049d828004c001000585028000c5020001000300034003800380030004c00380020784430241c4010087c4c0049d8280048001000585028000c5020001000380024003000380038003c003000407c440024144000087c4c3049d8280044001000585028000c5020001000300044003800280030003c003800307c4430241c400008704c4049d8280040002000585028000c5020001000380034003000480038002c003000307044402414401008744c4049d828004c001000585028000c5020001000300034003800380030004c00380020744440241c401008784c4049d8280048001000585028000c5028001000380024003000380038003c003000407844002414402008744c1049d8280044001000585028000c5028001000300044003800280030003c0038003078442024104030087c4c4049d8280040002000585028000c5028001000380034003000480038002c003000307844302410404008704c5049d828004c001000585028000c5028001000300034003800380030004c003800207044002414405008744c5049d8280048001000585028000c5028001000380024003000380038003c003000407444202414402008784c5049d8280044001000585028000c5028001000300044003800280030003c0038003074443024104030087c4c1049d8280040002000585028000c5028001000380034003000480038002c0030003074444024104040087c4c5049d828004c001000585028000c5028001000300034003800380030004c003800207044202414405008704c6049d8280048001000585028000c5028001000380024003000380038003c003000407044302414402008744c6049d8280044001000585028000c5028001000300044003800280030003c003800307044402410403008784c6049d8280040002000585028000c5028001000380034003000480038002c0030003078441024104040087c4c6049d828004c001000585028000c5028001000300034003800380030004c003800207c44202414405008704c7049d8280048001000585028000c5028001000380024003000380038003c003000407c44302414402008744c7049d8280044001000585028000c5028001000300044003800280030003c003800307044102410403008784c7049d8280040002000585028000c5028001000380034003000480038002c0030003074440024104040087c4c7049d828004c001000585028000c5028001000300034003800380030004c003800207c44002414405008704c8049d8280048001000585028000c5020002000380024003000380038003c003000407444202410402008744c8049d8280044001000585028000c5020002000300044003800280030003c003800307c44202418403008784c8049d8280040002000585028000c5020002000380034003000480038002c0030003078443024184040087c4c8049d828004c001000585028000c5020002000300034003800380030004c00380020704440241c405008704c9049d8280048001000585028000c5020002000380024003000380038003c003000407844002410402008744c9049d8280044001000585028000c5020002000300044003800280030003c003800307044202418403008784c9049d8280040002000585028000c5020002000380034003000480038002c0030003074440024184040087c4c9049d828004c001000585028000c5020002000300034003800380030004c00380020744430241c405008704ca049d8280048001000585028000c5020002000380024003000380038003c003000407c44302410402008744ca049d8280044001000585028000c5020002000300044003800280030003c003800307044002418403008784ca049d8280040002000585028000c5020002000380034003000480038002c0030003078441024184040087c4ca049d828004c001000585028000c5020002000300034003800380030004c00380020784420241c405008704cb049d8280048001000585028000c5020002000380024003000380038003c003000407044302410402008744cb049d8280044001000585028000c5020002000300044003800280030003c003800307c44002418403008784cb049d8280040002000585028000c5020002000380034003000480038002c0030003074444024184040087c4cb049d828004c001000585028000c5020002000300034003800380030004c00380020704410241c405008704cc049d8280048001000585028000c5028002000380024003000380038003c003000407044002418402008744cc049d8280044001000585028000c5028002000300044003800280030003c003800307444002414403008784cc049d8280040002000585028000c5028002000380034003000480038002c0030003070444024144040087c4cc049d828004c001000585028000c5028002000300034003800380030004c003800207444202418405008704cd049d8280048001000585028000c5028002000380024003000380038003c003000407c44002418402008744cd049d8280044001000585028000c5028002000300044003800280030003c003800307844102414403008784cd049d8280040002000585028000c5028002000380034003000480038002c0030003074443024144040087c4cd049d828004c001000585028000c5028002000300034003800380030004c003800207844002418405008704ce049d8280048001000585028000c5028002000380024003000380038003c003000407c44202418402008744ce049d8280044001000585028000c5028002000300044003800280030003c003800307444402414403008784ce049d8280040002000585028000c5028002000380034003000480038002c0030003078442024144040087c4ce049d828004c001000585028000c5028002000300034003800380030004c003800207c44302418405008704cf049d8280048001000585028000c5028002000380024003000380038003c003000407044202418402008744cf049d8280044001000585028000c5028002000300044003800280030003c003800307844302414403008784cf049d8280040002000585028000c5028002000380034003000480038002c0030003070441024144040087c4cf049d828004c001000585028000c5028002000300034003800380030004c003800207044302418405008704d0049d828004800100058d420100cd8281000dc301014d0382019f0280021f00800041000000030000000000000000030000000000001c4003000000000000f03f030000000000002840030000000000000040030000000000003140030000000000000840030000000000003640030000000000001040030000000000001440030000000000001840030000000000002040030000000000002240030000000000002440030000000000002640030000000000002a40030000000000002c40030000000000002e40030000000000003040030000000000003240030000000000003340030000000000003440030000000000003540030000000000003740030000000000003840030000000000003940030000000000003a40030000000000003b40030000000000003c40030000000000003d40030000000000003e40030000000000003f40030000000000004040030000000000804040030000000000004140030000000000804140030000000000004240030000000000804240030000000000004340030000000000804340030000000000004440030000000000804440030000000000004540030000000000804540030000000000004640030000000000804640030000000000004740030000000000804740030000000000004840030000000000804840030000000000004940030000000000804940030000000000004a40030000000000804a40030000000000004b40030000000000804b40030000000000004c40030000000000804c40030000000000004d40030000000000804d40030000000000004e40030000000000804e40030000000000004f40030000000000804f4003000000000000504000000000060000000115011a011601170118011902000000000000003d00cb020000f6000000f6000000f6000000f6000000f7000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000f9000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fa000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fb000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fc000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fd000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000fe000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff0000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000002010000020100000201000002010000020100000201000002010000020100000201000002010000020100000301000003010000030100000301000003010000030100000301000003010000030100000301000003010000040100000401000004010000040100000401000004010000040100000401000004010000040100000401000005010000050100000501000005010000050100000501000005010000050100000501000005010000050100000601000006010000060100000601000006010000060100000601000006010000060100000601000006010000070100000701000007010000070100000701000007010000070100000701000007010000070100000701000008010000080100000801000008010000080100000801000008010000080100000801000008010000080100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000a0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000b0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000c0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000d0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000e0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f0100000f01000010010000100100001001000010010000100100001001000010010000100100001001000010010000100100001101000011010000110100001101000011010000110100001101000011010000110100001101000011010000120100001201000012010000120100001201000012010000120100001201000012010000120100001201000013010000130100001301000013010000130100001301000013010000130100001301000013010000130100001401000014010000140100001401000014010000140100001401000014010000140100001401000014010000150100001501000015010000150100001501000015010000150100001501000015010000150100001501000016010000160100001601000016010000160100001601000016010000160100001601000016010000160100001701000017010000170100001701000017010000170100001701000017010000170100001701000017010000180100001801000018010000180100001801000018010000180100001801000018010000180100001801000019010000190100001901000019010000190100001901000019010000190100001901000019010000190100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001b0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001c0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001d0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001e0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f0100001f01000020010000200100002001000020010000200100002001000020010000200100002001000020010000200100002101000021010000210100002101000021010000210100002101000021010000210100002101000021010000220100002201000022010000220100002201000022010000220100002201000022010000220100002201000023010000230100002301000023010000230100002301000023010000230100002301000023010000230100002401000024010000240100002401000024010000240100002401000024010000240100002401000024010000250100002501000025010000250100002501000025010000250100002501000025010000250100002501000026010000260100002601000026010000260100002601000026010000260100002601000026010000260100002701000027010000270100002701000027010000270100002701000027010000270100002701000027010000280100002801000028010000280100002801000028010000280100002801000028010000280100002801000029010000290100002901000029010000290100002901000029010000290100002901000029010000290100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002a0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002c0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002d0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002e0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f0100002f01000030010000300100003001000030010000300100003001000030010000300100003001000030010000300100003101000031010000310100003101000031010000310100003101000031010000310100003101000031010000320100003201000032010000320100003201000032010000320100003201000032010000320100003201000033010000330100003301000033010000330100003301000033010000330100003301000033010000330100003401000034010000340100003401000034010000340100003401000034010000340100003401000034010000350100003501000035010000350100003501000035010000350100003501000035010000350100003501000036010000360100003601000036010000360100003601000036010000360100003601000036010000360100003701000037010000370100003701000037010000370100003701000037010000370100003701000037010000380100003801000038010000380100003801000038010000380100003801000038010000380100003801000039010000390100003901000039010000390100003901000039010000390100003901000039010000390100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003a0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003b0100003d0100003d0100003d0100003d0100003d0100003e0100000a0000000200000000000000410000000000cb0200000200000000000000420000000000cb0200000200000000000000430000000000cb0200000200000000000000440000000000cb0200000200000000000000580000000000cb0200000200000000000000610004000000cb0200000200000000000000620004000000cb0200000200000000000000630004000000cb0200000200000000000000640004000000cb0200000200000000000000740005000000cb020000060000000700000000000000434f4e5354530002000000000000007a0002000000000000006600020000000000000067000200000000000000680002000000000000006900420100005901000001001e6d000000550000009100c0008e808080d100c00019c08080170000808d004001188040011700008081000000c00000000501000041c100001d8100014501800085010000c18100009d810001ce0141015d81800185010001cf4180829d810001c501000101820000dd81000116c08101c680c101150100001101400258804002170000800341000003018000dd400001c500000207c1c1014701c2018741c201c781c20101020100550200008102000021820b80050380024503000380030000c00380050dc4c2055d83000281030300c1030300010403004104030081040300c1040300010503004105030081050300c1050300010603004106030081060300c106030001070300410703001d8300094683c10195030006584043071700008083430000830380005d4300014683c30147c3c30680030006c10301005d8380010a4303814503800380030002c00380020004000340048003800400065d430103c001000880018007400100070001800620c2f37f050200044102040085028004c00200029d820001c502800400038002dd82000105038004400300031d83000145038004800380035d0300011e0200001f0200001f00800011000000030000000000005040030000000000004c4003000000000000000003000000000000604003000000000000f03f03000000000000204004070000000000000061737365727400030000000000405040030000000000805040030000000000c05040030000000000005140030000000000804f400300000000000010400300000000000030400406000000000000007461626c650004070000000000000072656d6f7665000411000000000000002530387825303878253038782530387800000000000a00000001010104010e0000011501110105011b0103011202000000000000003d006d000000430100004401000044010000460100004601000046010000460100004801000048010000480100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004a0100004c0100004c0100004c0100004c0100004c0100004c0100004c0100004c0100004e0100004f0100004f0100004f0100004f0100005101000051010000510100005101000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005201000052010000520100005301000053010000530100005301000053010000530100005301000054010000540100005401000054010000540100005401000055010000550100005501000055010000550100005501000055010000550100005501000055010000550100005101000058010000580100005801000058010000580100005801000058010000580100005801000058010000580100005801000058010000580100005801000058010000590100000d00000002000000000000007300000000006d00000007000000000000006d73674c656e00010000006d00000007000000000000007061644c656e00030000006d00000002000000000000007400240000006d00000002000000000000006100280000006d00000002000000000000006200280000006d00000002000000000000006300280000006d00000002000000000000006400280000006d0000000c0000000000000028666f7220696e64657829002b0000005c0000000c0000000000000028666f72206c696d697429002b0000005c0000000b0000000000000028666f72207374657029002b0000005c000000020000000000000069002c0000005b00000002000000000000005800430000005b0000000a0000000500000000000000636861720004000000000000007265700008000000000000006c6569327374720005000000000000005f454e56000700000000000000434f4e535453000b000000000000006375745f6c655f737472000400000000000000737562000a000000000000007472616e73666f726d000700000000000000666f726d6174000500000000000000737761700001000000000002000000000000003d00aa00000005000000050000000500000005000000050000000500000005000000050000000500000005000000060000000800000008000000080000000800000009000000090000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000a0000000c0000000c0000000c0000000c0000000c0000000c0000000e0000000e0000001000000014000000180000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001a0000001b0000001b0000001b0000001b0000001b0000001b0000001b0000001b0000001b0000001b000000270000003200000034000000410000004100000055000000550000006600000066000000770000007700000088000000880000009900000099000000a5000000a5000000a5000000ad000000b6000000bf000000ca000000cc000000d0000000d5000000d7000000d8000000d8000000d8000000d8000000d9000000d9000000d9000000d9000000da000000da000000da000000da000000db000000db000000db000000db000000dc000000dc000000dc000000dc000000dd000000dd000000dd000000dd000000de000000de000000de000000de000000df000000df000000df000000df000000e0000000e0000000e0000000e0000000e1000000e1000000e1000000e1000000e2000000e2000000e2000000e2000000e3000000e3000000e3000000e3000000e4000000e4000000e4000000e4000000e4000000e5000000e5000000e5000000e5000000e6000000e6000000e6000000e6000000e7000000e7000000e7000000e7000000e8000000e8000000e8000000e9000000e9000000eb000000ec000000ed000000ee000000f30000003e010000590100005b0100005b0100005b0100005b0100005c0100002200000008000000000000007375626a6563740000000000aa000000050000000000000063686172000a000000aa000000050000000000000062797465000a000000aa0000000700000000000000666f726d6174000a000000aa0000000400000000000000726570000a000000aa0000000400000000000000737562000a000000aa00000007000000000000006269745f6f72000b000000aa00000008000000000000006269745f616e64000b000000aa00000008000000000000006269745f6e6f74000b000000aa00000008000000000000006269745f786f72000b000000aa0000000b000000000000006269745f727368696674000b000000aa0000000b000000000000006269745f6c7368696674000b000000aa00000003000000000000006f6b000f000000aa0000000400000000000000626974000f000000aa0000000600000000000000746f62697400270000003d0000000a000000000000006e6f726d616c697a6500280000003d0000000b0000000000000074626c326e756d626572003f000000500000000700000000000000657870616e640040000000500000000800000000000000746f5f6269747300410000005000000008000000000000006c6569327374720051000000aa0000000800000000000000737472326265690052000000aa0000000800000000000000737472326c65690053000000aa0000000b000000000000006375745f6c655f7374720054000000aa0000000500000000000000737761700055000000aa0000000e000000000000006865783262696e6172796175780056000000aa0000000b000000000000006865783262696e6172790057000000aa0000000700000000000000434f4e535453009e000000aa000000020000000000000066009f000000aa00000002000000000000006700a0000000aa00000002000000000000006800a1000000aa00000002000000000000006900a2000000aa00000002000000000000007a00a3000000aa0000000a000000000000007472616e73666f726d00a4000000aa000000080000000000000073756d6865786100a5000000aa0000000100000005000000000000005f454e5600'));
  end;

  -- Reset display
  function resetDisplay()
    Controls['Projector Name'].String = '';
    Controls['Manufacturer'].String = '';
    Controls['Product Name'].String = '';
    Controls['Lamp Hours'].String = '';
    Controls['Info'].String = '';
    Controls['Power Status'].Boolean = false;
    Controls['AVMute Status'].Boolean = false;
    Controls['Current Input'].String = '';
    Controls['Operational Status'].Value = 3;
    Controls['Operational Status'].String = '';
    Controls['Fan Status'].Value = 3;
    Controls['Fan Status'].String = '';
    Controls['Lamp Status'].Value = 3;
    Controls['Lamp Status'].String = '';
    Controls['Temp Status'].Value = 3;
    Controls['Temp Status'].String = '';
    Controls['Cover Status'].Value = 3;
    Controls['Cover Status'].String = '';
    Controls['Filter Status'].Value = 3;
    Controls['Filter Status'].String = '';
    Controls['Other Status'].Value = 3;
    Controls['Other Status'].String = '';
  end;




  -- Handle IP and port changes
  function changeConnection()

    SOCKET:Disconnect();
    --resetDisplay();
    
    local valid = true;
    
    -- Check if new IP is valid
    if(not checkIP(Controls['IP Address'].String)) then
      Controls['IP Address'].Color = 'red';
      valid = false;
    else
      Controls['IP Address'].Color = 'white';
    end;
    
    -- Check if new port is valid
    if(Controls['Port'].String:match('%D')) then
      Controls['Port'].Color = 'red';
      valid = false;
    else
      Controls['Port'].Color = 'white';
    end;
    
    -- Don't try to reconnect with invalid details
    if(not valid) then
      print('IP or port not valid');
      SOCKET:Disconnect();
      return;
    end;
    
    -- Connect!
    SOCKET:Connect(Controls['IP Address'].String, tonumber(Controls['Port'].String));
    print('Starting up');
    
  end;

  -- PJLink Input Names
  function getNameForInput(input)
    local typeCode = tonumber(input:sub(1,1));
    local index = tonumber(input:sub(2));
    
    if(Controls['Input Nicknames'] ~= nil) then
      local customName = Controls['Input Nicknames'][(typeCode-1)*9 + (index-1) + 1].String;
      if(customName ~= nil and customName ~= '') then return customName; end;
    end;
    
    return (typeCode == 1 and 'RGB' or '')
        .. (typeCode == 2 and 'Video' or '')
        .. (typeCode == 3 and 'Digital' or '')
        .. (typeCode == 4 and 'Storage' or '')
        .. (typeCode == 5 and 'Network' or '')
        .. ' ' .. index;
  end;
  

  -- PJLink response handler
  function parseLine(line)
print(line)
    -- Password highlight
    if(line == 'PJLINK ERRA') then
      Controls['Connection Status'].Value = 2;
      Controls['Connection Status'].String = 'wrong password';
      AUTHENTICATED = false;
    elseif(not line:match('^PJLINK ')) then
      Controls['Connection Status'].Value = 0;
      Controls['Connection Status'].String = '';
      AUTHENTICATED = true;
    end;

    -- Authentication
    if(line == 'PJLINK 0') then
      print('Authentication is disabled.');
    elseif(line:match('^PJLINK 1')) then
      print('Authentication is enabled.');
      local challenge = line:match('PJLINK 1 (.+)');
      local response = md5(challenge..(Controls['Password'].String));
      SOCKET:Write(response .. '%1POWR ?\r');
      ACCEPTING_UPDATES = true
      TIMER:Start(1.5)
      
    -- Handle command feedback silently
    elseif(line:match('^%%1....=ERR.')) then
      -- do nothing
    elseif(line:match('^%%1....=OK')) then
      -- do nothing
      
    -- Projector Information
    elseif(line:match('^%%1NAME=')) then
      Controls['Projector Name'].String = line:match('NAME=(.+)');
    elseif(line:match('^%%1INF1=')) then
      Controls['Manufacturer'].String = line:match('INF1=(.+)');
    elseif(line:match('^%%1INF2=')) then
      Controls['Product Name'].String = line:match('INF2=(.+)');
    elseif(line:match('^%%1INFO=')) then
      Controls['Extra Info'].String = line:match('INFO=(.+)');
    
    -- Operational features
    elseif(line:match('^%%1POWR=%d')) then
      local powerStatus = tonumber(line:match('POWR=(.+)'));
        if(ACCEPTING_UPDATES) then
          Controls['Power'].Boolean = (powerStatus % 2 == 1);
        end;

      if(powerStatus == 0) then
        Controls['Operational Status'].Value = 0;
        Controls['Operational Status'].String = 'Standby';
        Controls['Operational Status'].Color = "Pink"
        Controls['Power Status'].Color = "Red"
      elseif(powerStatus == 1) then
        Controls['Operational Status'].Value = 0;
        Controls['Operational Status'].String = 'Powered On';
        Controls['Operational Status'].Color = "Green"
        Controls['Power Status'].Color = "Green"
      elseif(powerStatus == 2) then
        Controls['Operational Status'].Value = 5;
        Controls['Operational Status'].String = 'Cooling';
        Controls['Operational Status'].Color = "Blue"
        Controls['Power Status'].Color = "Blue"
      elseif(powerStatus == 3) then
        Controls['Operational Status'].Value = 5;
        Controls['Operational Status'].String = 'Warming Up';
        Controls['Operational Status'].Color = "Orange"
        Controls['Power Status'].Color = "Orange"
      else
        Controls['Operational Status'].String = 'Not Connected';
        Controls['Operational Status'].Color = "OrangeRed"
      end;
    elseif(line:match('^%%1AVMT=%d')) then
        if(ACCEPTING_UPDATES) then
          Controls['AV Mute'].Boolean = (line:match('AVMT=%d(%d)')=='1');
        end;
      if Controls['AV Mute'].Boolean == true then
      Controls['AVMute Status'].Color = "Red"
      elseif Controls['AVMute'].Boolean == false then
      Controls['AV Mute Status'].Color = "White"
      end
     
    elseif(line:match('^%%1INPT=%d')) then
    print('THE INPUT IS'..(line:match('^%%1INPT=%d')))
        if(ACCEPTING_UPDATES) then
          Controls['Current Input'].String = getNameForInput(line:match('INPT=(.+)'));
           Controls['Input'].String = getNameForInput(line:match('INPT=(.+)'));
        end;
      
    -- Status monitoring
    elseif(line:match('^%%1LAMP=')) then
      Controls['Lamp Hours'].String = line:match('LAMP=(.+)'):gsub('(%d+) (%d)', '%1'); -- don't show lamp on/off
    elseif(line:match('^%%1ERST=')) then
      local errorCodes = { line:match('ERST=(%d)(%d)(%d)(%d)(%d)(%d)') };
      

      Controls['Fan Status'].String   = errorCodes[1];
      Controls['Lamp Status'].String   = errorCodes[2];
      Controls['Temp Status'].String   = errorCodes[3];
      Controls['Cover Status'].String  = errorCodes[4];
      Controls['Filter Status'].String = errorCodes[5];
      Controls['Other Status'].String  = errorCodes[6];
    
    -- Input sources
    elseif(line:match('^%%1INST=')) then
      local inputs = line:match('INST=(.+)');
      --print(inputs);
      local inputSelectOptions = {};
      INPUTS = {};
      for input in inputs:gmatch('(%d+)') do
        local inputName = getNameForInput(input);
        table.insert(inputSelectOptions, inputName);
        INPUTS[inputName] = input;
      end;
      Controls['Input'].Choices = inputSelectOptions;
      --print(json.encode(inputSelectOptions));
    
    else
      print('Unrecognised response', line);
    end;
    
  end;

  function sendCMD(cmd)
    SOCKET:Write('%1'..cmd..'\r');
  end;

  -- Polling and update timer
   powrtime = Timer.New()
  avmttime = Timer.New()
  ersttime = Timer.New()
  lamptime = Timer.New()
  insttime = Timer.New()
  nametime = Timer.New()
  inf1time = Timer.New()
  inf2time = Timer.New()
  infotime = Timer.New()
  inpttime = Timer.New()

  
  function poll()
   
  if ACCEPTING_UPDATES == true then
  powrtime:Start(.1)
  powrtime.EventHandler = powrtick
  
  else
  --do nothing
  end
  
  end
  
  function powrtick()
  powrtime:Stop()
    
    sendCMD('POWR ?');
  avmttime:Start(.1)
  avmttime.EventHandler = avmttick
  
  end
  
    function avmttick()
  avmttime:Stop()
    
    sendCMD('AVMT ?');
  ersttime:Start(.1)
  ersttime.EventHandler = ersttick
  
  end
  
      function ersttick()
  ersttime:Stop()
    
    sendCMD('ERST ?');
  lamptime:Start(.1)
  lamptime.EventHandler = lamptick
  
  end
        function lamptick()
  lamptime:Stop()
    
    sendCMD('LAMP ?');
  insttime:Start(.1)
  insttime.EventHandler = insttick
  
  end
        function insttick()
  insttime:Stop()
    
    sendCMD('INST ?');
  nametime:Start(.1)
  nametime.EventHandler = nametick
  
  end
          function nametick()
  nametime:Stop()
    
    sendCMD('NAME ?');
  inf1time:Start(.1)
  inf1time.EventHandler = inf1tick
  
  end
            function inf1tick()
  inf1time:Stop()
    
    sendCMD('INF1 ?');
  inf2time:Start(.1)
  inf2time.EventHandler = inf2tick
  
  end
              function inf2tick()
  inf2time:Stop()
    
    sendCMD('INF2 ?');
  inpttime:Start(.1)
  inpttime.EventHandler = inpttick
  
  end
                function inpttick()
  inpttime:Stop()
    
    sendCMD('INPT ?');
  infotime:Start(.1)
  infotime.EventHandler = infotick
  
  end
                function infotick()
  infotime:Stop()
    
    sendCMD('INFO ?');

  
  end
  


  function update()
  
  if ACCEPTING_UPDATES == true then
  
    if(Controls['Input'].String ~= Controls['Current Input'].String
        and INPUTS ~= nil
        and Controls['Input'].String ~= ''
        and INPUTS[Controls['Input'].String] ~= nil) then
      sendCMD('INPT ' .. INPUTS[Controls['Input'].String]);
      print('CHANGE INPT ' .. INPUTS[Controls['Input'].String])
    end

    if(Controls['Power'].Boolean ~= (Controls['Operational Status'].String~='Standby')) then
      sendCMD('POWR '..(Controls['Power'].Boolean and '1' or '0'));
    end;
    
    if(Controls['AV Mute'].Boolean ~= Controls['AVMute Status'].Boolean) then
      sendCMD('AVMT 3'..(Controls['AV Mute'].Boolean and '1' or '0'));
    end;
    
    else
    --do nothing
    end
  end;

  TIMER = Timer.New()
  TIMER.EventHandler = function()

    -- Don't bother polling if we're not connected and authenticated
    if((not SOCKET.IsConnected) or (not AUTHENTICATED)) then return; end;
    
    poll();
  
    update(); 
    

  
  TIMER:Start(1.5);
  end
  ACCEPT_TIMER = Timer.New();
  ACCEPT_TIMER.EventHandler = function()
    ACCEPT_TIMER:Stop();
    ACCEPTING_UPDATES = true;
  end;
  function delayPoll()
    ACCEPTING_UPDATES = false;
    ACCEPT_TIMER:Stop();
    ACCEPT_TIMER:Start(tonumber(200/1000));
  end;

  -- Socket connect handler
  SOCKET.EventHandler = function(sock,evt,tbl)
    --print(sock,evt,tbl);
    if(evt == TcpSocket.Events.Connected) then
      print('Connected');
      Controls['Connection Status'].Value = 5;
      Controls['Connection Status'].String = 'Authenticating';
      AUTHENTICATED = false;
    elseif(evt == TcpSocket.Events.Data) then
      local line = sock:ReadLine(TcpSocket.EOL.Any)
      while(line ~= nil) do
        parseLine(line);
        line = sock:ReadLine(TcpSocket.EOL.Any);
      end;
    elseif(evt == TcpSocket.Events.Timeout) then
      Controls['Connection Status'].Value = 2;
      Controls['Connection Status'].String = 'timeout';
    elseif(evt == TcpSocket.Events.Reconnect) then
      Controls['Connection Status'].Value = 5;
      Controls['Connection Status'].String = 'connecting';
    elseif(evt == TcpSocket.Events.Closed) then
      Controls['Connection Status'].Value = 2;
      Controls['Connection Status'].String = 'closed by remote';
    elseif(evt == TcpSocket.Events.Error) then
      Controls['Connection Status'].Value = 2;
      Controls['Connection Status'].String = 'socket error';
    else
      Controls['Connection Status'].Value = 1;
      Controls['Connection Status'].String = 'bad socket event';
    end;
  end;

  -- Helper function (check IP validity)
  function checkIP(ip)
    local chunks = {ip:match("(%d+)%.(%d+)%.(%d+)%.(%d+)")}
    if (#chunks == 4) then
      for _,v in pairs(chunks) do
        if (tonumber(v) < 0 or tonumber(v) > 255) then
          return false;
        end
      end
      return true;
    else
      return false;
    end
  end;

  -- Bindings
  Controls['IP Address'].EventHandler = changeConnection;
  Controls['Port'].EventHandler = changeConnection;
  Controls['Password'].EventHandler = changeConnection;
  changeConnection();

  Controls['Power'].EventHandler = function(c)
    sendCMD('POWR '..(c.Boolean and '1' or '0'));
    delayPoll();
  end;
  Controls['AV Mute'].EventHandler = function(c)
    sendCMD('AVMT 3'..(c.Boolean and '1' or '0'));
    delayPoll();
  end;;
  Controls['Input'].EventHandler = function(c)
  if(INPUTS ~= nil and c.String ~= '' and INPUTS[c] ~= nil) then
      sendCMD('INPT ' .. INPUTS[Controls['Input'].String]);
   end;
    delayPoll();
  end
end